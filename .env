#
# Pilot defaults (Ubuntu + PostgreSQL, persistent local disk under ./data/)
#
# Profiles: full (everything) | edge (proxy + agent only).
#   full: docker compose --profile full up -d
#   edge: set ZABBIX_SERVER_ADDRESS to your central Zabbix server, then: docker compose --profile edge up -d

# Central Zabbix server (for edge profile only; leave unset for full stack)
# ZABBIX_SERVER_ADDRESS=zabbix-server
# ZABBIX_SERVER_PORT=10051

# Agent active checks: who the agent connects to for config and to send results. Full stack: leave unset (default zabbix-server). Edge: set to zabbix-proxy so the agent talks to the local proxy and gets active check config (otherwise you get "no active checks, host monitored by proxy" and config update fails).
# ZABBIX_AGENT_ACTIVE_SERVER=zabbix-proxy

# Images
POSTGRES_IMAGE=postgres:17-alpine
ZABBIX_SERVER_IMAGE=zabbix/zabbix-server-pgsql:ubuntu-7.4-latest
ZABBIX_WEB_IMAGE=zabbix/zabbix-web-nginx-pgsql:ubuntu-7.4-latest
# Proxy (SQLite3). Default official image (commented); we use Hyperscale AV image by default.
# ZABBIX_PROXY_IMAGE=zabbix/zabbix-proxy-sqlite3:ubuntu-7.4-latest
ZABBIX_PROXY_IMAGE=ghcr.io/hyperscaleav/zabbix-proxy-sqlite3:ubuntu-7.4.6
# Agent that monitors the host running the Zabbix server
ZABBIX_AGENT_IMAGE=zabbix/zabbix-agent:ubuntu-7.4-latest

# Ports on the host
ZABBIX_SERVER_PORT=10051
ZABBIX_AGENT_PORT=10050
ZABBIX_WEB_HTTP_PORT=80
ZABBIX_WEB_HTTPS_PORT=443

# Database (pilot defaults; change before internet exposure)
POSTGRES_DB=zabbix
POSTGRES_USER=zabbix
POSTGRES_PASSWORD=zabbix

# Web timezone
PHP_TZ=UTC

# Agent that monitors this host (Zabbix server host)
# Create a host in Zabbix UI with this exact name and use “Zabbix agent” interface pointing at zabbix-agent:10050 (or host IP:10050)
ZABBIX_AGENT_HOSTNAME=Zabbix server

# Hosts allowed to connect to the agent for passive checks (must include the proxy so it can poll the agent).
# Full stack: leave unset (default: zabbix-server,zabbix-proxy). Edge: use a CIDR for the Docker network, e.g. 172.18.0.0/24 (adjust if your bridge subnet differs).
# ZABBIX_AGENT_PASSIVESERVERS=172.18.0.0/24

# Proxy settings
# This is how the proxy will be named inside Zabbix (UI -> Administration -> Proxies)
ZABBIX_PROXY_HOSTNAME=av-proxy-1

# Proxy behaviour – these defaults are tuned for AV use
ZBX_PROXYMODE=0                 # 0 = active proxy, 1 = passive
ZBX_PROXYBUFFERMODE=hybrid      # how data is buffered when link is bad
ZBX_PROXYMEMORYBUFFERAGE=1800   # seconds
ZBX_PROXYMEMORYBUFFERSIZE=256M  # memory buffer size
ZBX_ENABLEREMOTECOMMANDS=1      # allow remote commands from server
